"use strict";function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}();!function(e){function r(n){if(t[n])return t[n].exports;var i=t[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}var t={};return r.m=e,r.c=t,r.p="",r(0)}([function(e,r){var t=function(){function e(r){var t=this;_classCallCheck(this,e),this.topic=r,this.promise=new Promise(function(e,r){t.resolve=e,t.reject=r})}return _createClass(e,[{key:"link",value:function(e){if(this.externalPromise)throw new Error("Milestone is already linked to a promise");return this.externalPromise=e,this.externalPromise.then(this.resolve)["catch"](this.reject),this}},{key:"reached",value:function(){return this.promise}}]),e}(),n=function(){function e(){_classCallCheck(this,e),this.registry={}}return _createClass(e,[{key:"register",value:function(e,r){return this.getOrCreate(e).link(r)}},{key:"getOrCreate",value:function(e){return this.registry[e]||(this.registry[e]=new t(e)),this.registry[e]}},{key:"when",value:function(){var e=this,r=Array.prototype.slice.call(arguments,0);return Promise.all(r.map(function(r){return e.getOrCreate(r).reached()}))}}]),e}();e.exports=n}]);